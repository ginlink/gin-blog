---
sidebar_position: 3
---

[1] [Rustè¯­è¨€å…¥é—¨è§†é¢‘æ•™ç¨‹ï¼ŒRustç¼–ç¨‹å…¥é—¨è§†é¢‘æ•™ç¨‹ï¼ˆè§†é¢‘ï¼‰](https://www.bilibili.com/video/BV1hp4y1k7SV)

[2] [Rust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆï¼ˆæ–‡æ¡£ï¼‰](https://kaisery.github.io/trpl-zh-cn/ch07-05-separating-modules-into-different-files.html)

## 3 é€šç”¨ç¼–ç¨‹èŒƒå¼

- 3.1 - å˜é‡ä¸å¯å˜æ€§
- 3.2 - æ•°æ®ç±»å‹ï¼šæ ‡é‡ç±»å‹
- 3.3 - æ•°æ®ç±»å‹ï¼šå¤åˆç±»å‹
- 3.4 - å‡½æ•°å’Œæ³¨é‡Š
- 3.5 - æ§åˆ¶æµ

### 3.1 - å˜é‡ä¸å¯å˜æ€§

##### å˜é‡

å˜é‡é»˜è®¤æ˜¯ä¸å¯æ”¹å˜çš„ï¼ˆimmutableï¼‰ï¼Œè¿™æ˜¯ Rust æä¾›ç»™ä½ çš„ä¼—å¤šä¼˜åŠ¿ä¹‹ä¸€ã€‚

```rust
fn main() {
  let x = 5;
  println!("The value of x is: {x}");
  x = 6;
  println!("The value of x is: {x}");
}
=>> âŒ
```

> æŠ¥é”™ï¼šx = 6;  |     ^^^^^ cannot assign twice to immutable variable

```rust
fn main() {
  let mut x = 5;
  x = 6;
}

=>> âœ…
```

##### å¸¸é‡

ç¤ºä¾‹

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

##### éšè—

æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸ä¹‹å‰å˜é‡åŒåçš„æ–°å˜é‡ï¼Œç¼–è¯‘å™¨å°†çœ‹åˆ°ç¬¬äºŒä¸ªå˜é‡ï¼Œç¬¬äºŒä¸ªå˜é‡ â€œéšè—â€ äº†ç¬¬ä¸€ä¸ªå˜é‡ã€‚

ç¤ºä¾‹

```rust
fn main() {
  let x = 5;

  let x = x + 1;

  {
    let x = x * 2;
    println!("The value of x in the inner scope is: {x}");
  }

  println!("The value of x is: {x}");
}

=>> 
The value of x in the inner scope is: 12
The value of x is: 6
```

éšè—äºmutçš„åŒºåˆ«ï¼š

- é‡æ–°èµ‹å€¼å¦‚æœä¸æ˜¯mutï¼Œåˆ™ä¼šæŠ¥é”™ï¼›è€Œä¸”éšè—åè¿˜æ˜¯ä¸å¯å˜ç±»å‹
- éšè—å¯ä»¥æ”¹å˜æ•°æ®ç±»å‹

```rust
let spaces = "   ";					// å­—ç¬¦ä¸²ç±»å‹
let spaces = spaces.len();	// æ•°å­—ç±»å‹
```

### 3.2 - æ•°æ®ç±»å‹ï¼šæ ‡é‡ç±»å‹

rustæ˜¯ **é™æ€ç±»å‹**ï¼ˆ*statically typed*ï¼‰è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¼–è¯‘æ—¶å°±å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚

##### æ ‡é‡ç±»å‹

| ç±»å‹     |
| -------- |
| æ•´æ•°ç±»å‹ |
| æµ®ç‚¹ç±»å‹ |
| å¸ƒå°”ç±»å‹ |
| å­—ç¬¦ç±»å‹ |

**è¡¨æ ¼ 3-1: Rust ä¸­çš„æ•´å‹**

| é•¿åº¦    | æœ‰ç¬¦å·  | æ— ç¬¦å·  |
| ------- | ------- | ------- |
| 8-bit   | `i8`    | `u8`    |
| 16-bit  | `i16`   | `u16`   |
| 32-bit  | `i32`   | `u32`   |
| 64-bit  | `i64`   | `u64`   |
| 128-bit | `i128`  | `u128`  |
| arch    | `isize` | `usize` |

- æœ‰ç¬¦å·æ•°å­—èŒƒå›´ï¼š-(2n - 1) åˆ° 2n - 1 - 1
- æ— ç¬¦å·æ•°å­—èŒƒå›´ï¼š0 åˆ° 2n - 1
- `isize` å’Œ `usize` ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼š64 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œ 32 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 32 ä½çš„ï¼Œä½¿ç”¨åœºæ™¯æ˜¯å¯¹æŸç§é›†åˆè¿›è¡Œç´¢å¼•æ“ä½œ

##### æ•°å­—å­—é¢å€¼

**è¡¨æ ¼ 3-2: Rust ä¸­çš„æ•´å‹å­—é¢å€¼**

| æ•°å­—å­—é¢å€¼                    | ä¾‹å­          |
| ----------------------------- | ------------- |
| Decimal (åè¿›åˆ¶)              | `98_222`      |
| Hex (åå…­è¿›åˆ¶)                | `0xff`        |
| Octal (å…«è¿›åˆ¶)                | `0o77`        |
| Binary (äºŒè¿›åˆ¶)               | `0b1111_0000` |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äº`u8`) | `b'A'`        |

##### æ•´å‹æº¢å‡º

æº¢å‡ºä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š

- debug æ¨¡å¼ç¼–è¯‘æ—¶ï¼ŒRust æ£€æŸ¥è¿™ç±»é—®é¢˜å¹¶ä½¿ç¨‹åº *panic*
- åœ¨ release æ„å»ºä¸­ï¼ŒRust ä¸æ£€æµ‹æº¢å‡ºï¼Œç›¸åä¼šè¿›è¡Œä¸€ç§è¢«ç§°ä¸ºäºŒè¿›åˆ¶è¡¥ç åŒ…è£…ï¼ˆç¯ç»•ï¼‰ï¼Œå³å€¼ `256` å˜æˆ `0`ï¼Œå€¼ `257` å˜æˆ `1`ï¼Œä¾æ­¤ç±»æ¨

##### æµ®ç‚¹ç±»å‹

rustä¸­ï¼Œæµ®ç‚¹æ•°é‡‡ç”¨ IEEE-754 æ ‡å‡†è¡¨ç¤ºã€‚`f32` æ˜¯å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œ`f64` æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆé»˜è®¤ï¼‰ã€‚

Rust ä¸­çš„æ‰€æœ‰æ•°å­—ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€é™¤æ³•å’Œå–ä½™ã€‚æ•´æ•°é™¤æ³•ä¼š `å‘ä¸‹èˆå…¥` åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚

##### å­—ç¬¦ç±»å‹

å å››ä¸ªå­—èŠ‚å¤§å°ï¼Œç”¨å•å¼•å·å£°æ˜

```rust
let c = 'z';
let z: char = 'â„¤'; // with explicit type annotation
let heart_eyed_cat = 'ğŸ˜»';
```

### 3.3 - æ•°æ®ç±»å‹ï¼šå¤åˆç±»å‹

Rust æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚

##### å…ƒç»„ç±»å‹

å°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚

```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);
```

å…ƒç»„è§£æ„

```rust
let tup = (500, 6.4, 1);
let (x, y, z) = tup;
```

ç‚¹å·è®¿é—®

```rust
let x: (i32, f64, u8) = (500, 6.4, 1);
let five_hundred = x.0;
=>> 500
```

##### æ•°ç»„ç±»å‹

ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ `ç±»å‹å¿…é¡»ç›¸åŒ`

```rust
let a = [1, 2, 3, 4, 5];
```

ç±»å‹å£°æ˜

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
// 5ä¸ªå…ƒç´ ï¼Œéƒ½æ˜¯i32ç±»å‹

let a = [3; 5];
// 5ä¸ªå…ƒç´ ï¼Œå€¼éƒ½æ˜¯3
```

### 3.4 - å‡½æ•°å’Œæ³¨é‡Š

Rust ä»£ç ä¸­çš„å‡½æ•°å’Œå˜é‡åä½¿ç”¨ *snake case* è§„èŒƒé£æ ¼

```rust
fn main() {
  another_function(5);
}

fn another_function(x: i32) {
  println!("The value of x is: {x}");
}
```

- åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ**å¿…é¡»** å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹
- å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—çš„è¯­å¥å’Œä¸€ä¸ªå¯é€‰çš„ç»“å°¾è¡¨è¾¾å¼æ„æˆ

##### è¯­å¥å’Œè¡¨è¾¾å¼

Rust æ˜¯ä¸€é—¨åŸºäºè¡¨è¾¾å¼ï¼ˆexpression-basedï¼‰çš„è¯­è¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„ï¼ˆä¸åŒäºå…¶ä»–è¯­è¨€ï¼‰é‡è¦åŒºåˆ«

| åç§°                                                    | ä¾‹å­                                                         | é”™è¯¯ä¾‹å­âŒ                            |
| ------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------ |
| **è¯­å¥**ï¼ˆ*Statements*ï¼‰æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤  | let y = 6;                                                   | x = y = 6ï¼Œå› ä¸ºy=6åœ¨rustä¸­æ²¡æœ‰è¿”å›å€¼ |
| **è¡¨è¾¾å¼**ï¼ˆ*Expressions*ï¼‰è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥è¢«èµ‹å€¼ | å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å®è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ç”¨å¤§æ‹¬å·åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„å—ä½œç”¨åŸŸä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ |                                      |

```rust
let y = {
  let x = 3;
  x + 1
};

=>> y is 3
```

è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æœåœ¨è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼

##### æ³¨é‡Š

| å•è¡Œæ³¨é‡Š | æ–‡æ¡£æ³¨é‡Š |
| -------- | -------- |
| //       | ///      |

### 3.5 - æ§åˆ¶æµ

##### if è¡¨è¾¾å¼

```rust
if number % 4 == 0 {
  println!("number is divisible by 4");
} else if number % 3 == 0 {
  println!("number is divisible by 3");
} else {
  println!("number is not divisible by 4, 3, or 2");
}
```

æ³¨æ„ï¼Œä»£ç ä¸­çš„æ¡ä»¶ **å¿…é¡»** æ˜¯ `bool` å€¼ï¼Œå¦åˆ™ä¼šåˆ°ä¸€ä¸ªé”™è¯¯

##### åœ¨ `let` è¯­å¥ä¸­ä½¿ç”¨ `if`

å› ä¸º `if` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `let` è¯­å¥çš„å³ä¾§ä½¿ç”¨å®ƒ

```rust
let number = if condition { 5 } else { 6 };
```

##### å¾ªç¯

Rust æœ‰ä¸‰ç§å¾ªç¯ï¼š`loop`ã€`while` å’Œ `for`

**loopé‡å¤å¾ªç¯**

```rust
loop {
  println!("again!");
}
```

**ä»å¾ªç¯è¿”å›å€¼**

```rust
let result = loop {
  counter += 1;

  if counter == 10 {
    break counter * 2;
  }
};
```

**å¾ªç¯æ ‡ç­¾ï¼šåœ¨å¤šä¸ªå¾ªç¯ä¹‹é—´æ¶ˆé™¤æ­§ä¹‰**

æ³¨æ„æ ‡ç­¾æ˜¯ä¸€ä¸ªå•å¼•å·

```rust
let mut count = 0;
'counting_up: loop {
  println!("count = {count}");
  let mut remaining = 10;

  loop {
    println!("remaining = {remaining}");
    if remaining == 9 {
      break;
    }
    if count == 2 {
      break 'counting_up;
    }
    remaining -= 1;
  }

  count += 1;
}
println!("End count = {count}");
```

**whileæ¡ä»¶å¾ªç¯**

```rust
while number != 0 {
  println!("{number}!");

  number -= 1;
}
```

**ä½¿ç”¨ `for` éå†é›†åˆ**

```rust
let a = [10, 20, 30, 40, 50];

for element in a {
  println!("the value is: {element}");
}
```

```rust
for number in (1..4).rev() {
  println!("{number}!");
}
```

- (1...4) è¡¨ç¤ºäº§ç”Ÿéšæœºæ•°1~4ï¼ˆå·¦é—­å³å¼€ï¼‰

- revè¡¨ç¤ºåè½¬

