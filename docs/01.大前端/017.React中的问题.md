---
title: 017.React子问题
categories:
  - 大前端
tags:
  - react
---



## 1 create-react-app支持导入svg为组件

```tsx
import { ReactComponent as Logo } from './logo.svg';
// 名称必须为ReactComponent

function App() {
  return (
    <div>
      {/* Logo is an actual React component */}
      <Logo />
    </div>
  );
}
```

## 2 react中，对象的属性变化了会导致依赖更新吗？

~~`首先，在react中不存在直接去改对象属性的情况`~~

注意，在16.8以上的函数式组件中，React只要页面有更新，那么函数组件就会再次执行一遍

```tsx
export default function Home(){

}
```



请看下面例子

```ts
const [person, setPerson] = useState<any>({})

person.name = 'John' // 这里值会变，但不触发页面刷新
setPerson(person) // 这里触发页面刷新

// 等效代码为
setPerson({...person, name: 'John'})
```

也就是，如果是手动改写对象属性，那么不会，如果是用setState()，则会，也就是页面刷新与对象本身没有绝对关系

基本上，状态量如果是引用类型，那么每次去修改都是 `setState(newVal)`，所以每次的值都是一个新引用类型，所以只要有属性变化，对象一定会变化（因为是一个全新的对象）

> 下面是一个例子，还有如何去拿上一次的状态量

```ts
const [obj, setObj] = useState<Object>({name: '张三'})

useEffect(() => {
    const timer = setInterval(()=>{
        setObj((prev: any)=>{
            // 获取上一次的状态量
            console.log('[上次的state]:', prev)
            const { age } = prev

            return age ? {...prev, age: age+1} : {...prev, age: 23}
        })
    }, 1000)

    return ()=>{
        clearInterval(timer)
    }
}, [])

useEffect(() => {
    console.log('[obj更新了]:', obj)

    // setObj({...obj, age: 23, now})
    // 不要尝试更新自己依赖的数据，否则死循环
}, [now, obj])
```

## 3 使用create-react-app创建ts项目

```sh
create-react-app my-app --template typescript
```

[1] 使用create-react-app创建ts项目.https://www.cnblogs.com/feiyu159/p/14154963.html

## 4 注意ts和tsx文件的区别

有时候导入一个组件，使用的时候，提示 `xxx为值，该处却用作类型，是否指的是类型xxx`

最后将 `.ts`后缀改为 `.tsx`即可

## 5 覆盖antd的组件样式

```tsx
import { Menu as Menud } from 'antd'
const Menu = styled(Menud)`
    border-right: none;

    & > li {
    /* background-color: red; */
    background-color: rgba(0, 118, 255, 0.05);
    border-radius: 24px;
    }
    &.li::after {
    border: none;
    }

    .ant-menu-item-selected::after {
    content: none;
    }
`
```

