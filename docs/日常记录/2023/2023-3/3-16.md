---
sidebar_position: 3
title: 3-16
tags:
  - 日常记录
---



## 1 Node分布式

### Cap理论

一个分布式系统最多可满足：一致性、可用性、分区容忍性的其中两项

### 进程与线程

- 进程：一个独立的程序，是操作系统分配资源的最小单位
- 线程：是进程中执行运行的最小单位

### Node特性

- 单线程
- 异步I/O
- 事件驱动

### Node分布式

- Nginx：调度，负载均衡
- Node集群：处理业务
- Redis：同步状态

![image-20230316212856485](https://cdn.gincool.com/img/image-20230316212856485.png)

### Node多线程运行

> cluster模块，一个主线程，多个worker线程，通过算法协调worker之间的

[1] [【已完结】最新node分布式大全](https://www.bilibili.com/video/BV1bg411x7Xm?p=3&spm_id_from=pageDriver&vd_source=4065bea3d3139c3fda8b128a6a3a90a7)

## 2 for of 如何获取索引

```ts
for (const [index, item] of arr.entries()) {
  // ...
}
```

## 3 加载字体示例

https://fonts.googleapis.com/css?family=Open+Sans:100,400,400i,600,800

[1] [转换字体格式](https://transfonter.org/)

## 4 docker redis with password

redis设置密码

```sh
docker run -d \
  -h redis \
  -v $PWD/redis:/data \
  -p 6380:6379 \
  --name my-redis2 \
  --restart always \
  redis redis-server --appendonly yes  --requirepass "ginlink"
```

## 5 小程序局部刷新

思想：1.同组件，删除一个元素时，给元素打标记，UI层根据该标记显示或隐藏 2.跨组件同理，将数据放状态管理器中 3.同组件虚拟列表同理 4.跨组件虚拟列表，暂无解决方案

[1] [微信小程序setData局部刷新列表](https://www.cnblogs.com/liangyuji/p/13509598.html)

## 6 mongo设置密码并设置持久化目录

```sh
docker run -d \
    -p 27018:27017 \
    -v ~/data/mongo/mg-node-columns:/data/db \ 
    -e MONGO_INITDB_ROOT_USERNAME=root \  
    -e MONGO_INITDB_ROOT_PASSWORD=admin \     
    --name mg-node-columns \ 
    mongo
```

## 7 Nestjs有哪些异常

1. HttpException：HTTP 异常，用于表示 HTTP 响应中的错误状态码，例如 400、401、404 等。可以在控制器中抛出 HttpException，Nest.js 将自动处理并生成相应的 HTTP 响应。
2. BadRequestException：用于表示客户端发送了无效请求的异常，通常与 HTTP 状态码 400（Bad Request）一起使用。
3. UnauthorizedException：用于表示未经授权的请求的异常，通常与 HTTP 状态码 401（Unauthorized）一起使用。
4. NotFoundException：用于表示请求的资源不存在的异常，通常与 HTTP 状态码 404（Not Found）一起使用。
5. ForbiddenException：用于表示请求的操作不被允许的异常，通常与 HTTP 状态码 403（Forbidden）一起使用。
6. InternalServerErrorException：用于表示服务器内部错误的异常，通常与 HTTP 状态码 500（Internal Server Error）一起使用。
7. RpcException：用于表示 RPC 调用失败的异常，例如使用 Microservices 时发生的错误。
8. WebSocketException：用于表示 WebSocket 连接错误的异常，例如连接关闭或消息发送失败。

## 8 Nestjs 如何指定内容到 dist 中？

[1] https://docs.nestjs.com/cli/monorepo#assets

Nestjs 不会自动输出一些杂项，要输出指定内容到 dist，需要配置 assets 字段，例如：复制 resources/* 到 dist/src 中（整个 resources 目录被复制到 dist/src 中）

```json
{
  "$schema": "https://json.schemastore.org/nest-cli",
  "collection": "@nestjs/schematics",
  "sourceRoot": "src",
  "compilerOptions": {
    "assets": [
      {
        "include": "resources/*",
        "outDir": "dist/src"
      }
    ]
  }
}
```

