---
sidebar_position: 2
title: 7-23
tags:
  - 日常记录
---



## 1 前端AES加密

### 依赖

```sh
yarn add crypto-js
yarn add -D @types/crypto-js
```

### 示例

```ts
import CryptoJS from 'crypto-js'

const key = '6fa979f20126cb08aa645a8f495f6d85';
const iv = 'I8zyA4lVhMCaJ5Kg';

const utf8PubKeyArr = CryptoJS.enc.Utf8.parse(key)
const utf8IvArr = CryptoJS.enc.Utf8.parse(iv)

// Encrypt
export function getBase64AESCode(origin: string) {
  const res = CryptoJS.AES.encrypt(origin, utf8PubKeyArr, {
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7,
    iv: utf8IvArr,
  }).ciphertext

  return CryptoJS.enc.Base64.stringify(res)
}

// Decrypt
export function parseBase64AESCode(base64Encrypted: string) {
  const encrypted = CryptoJS.lib.CipherParams.create({
    ciphertext: CryptoJS.enc.Base64.parse(base64Encrypted),
  })

  return CryptoJS.AES.decrypt(encrypted, utf8PubKeyArr, {
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7,
    iv: utf8IvArr,
  }).toString(CryptoJS.enc.Utf8)
}
```

### ~~rsa256~~

rsa256通过 [jsencrypt](https://www.npmjs.com/package/jsencrypt) 包使用，但该包只能在客户端使用，无法正常用于nextjs，所以改用aes

### 参考

[1] https://cryptojs.gitbook.io/docs/

![image-20220725221638337](https://cdn.gincool.com/img/image-20220725221638337.png)

[2] [CryptoJS encrypt in aes-256-cbc returns an unexpected value](https://stackoverflow.com/questions/57416217/cryptojs-encrypt-in-aes-256-cbc-returns-an-unexpected-value)

![image-20220725221607388](https://cdn.gincool.com/img/image-20220725221607388.png)

[3] [在线aes装换](https://the-x.cn/cryptography/Aes.aspx)

![image-20220725221535025](https://cdn.gincool.com/img/image-20220725221535025.png)

